<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userQnaMapper">
    
    <resultMap id="userQnaResultSet" type="UserQnaInfo">
        <result column="USERQNA_NUM" property="userQnaNum"/>
        <result column="USER_NO" property="userNo"/>
        <result column="USERQNA_TITLE" property="userQnaTitle"/>
        <result column="USERQNA" property="userQna"/>
        <result column="EXUSER_NUM" property="exuserNum"/>
        <result column="USERQNA_IMG" property="userQnaImg"/>
    </resultMap>
    
    <select id="selectUserQnaList" resultMap="userQnaResultSet">
        SELECT * FROM USERQNA ORDER BY USERQNA_NUM DESC
    </select>
    
    <select id="selectUserQna" parameterType="_int" resultMap="userQnaResultSet">
        SELECT * FROM USERQNA WHERE USERQNA_NUM = #{userQnaNum}
    </select>
    
    <insert id="insertUserQna" parameterType="UserQnaInfo">
        INSERT INTO USERQNA (USERQNA_NUM, USER_NO, USERQNA_TITLE, USERQNA, EXUSER_NUM, USERQNA_IMG)
        VALUES (SEQ_USERQNA.NEXTVAL, #{userNo}, #{userQnaTitle}, #{userQna}, #{exuserNum}, #{userQnaImg})
    </insert>
    
    <update id="updateUserQna" parameterType="UserQnaInfo">
        UPDATE USERQNA SET 
            USERQNA_TITLE = #{userQnaTitle},
            USERQNA = #{userQna},
            USERQNA_IMG = #{userQnaImg}
        WHERE USERQNA_NUM = #{userQnaNum}
    </update>
    
    <delete id="deleteUserQna" parameterType="_int">
        DELETE FROM USERQNA WHERE USERQNA_NUM = #{userQnaNum}
    </delete>
    
    <select id="selectUserQnaByUser" parameterType="_int" resultMap="userQnaResultSet">
        SELECT * FROM USERQNA WHERE USER_NO = #{userNo} ORDER BY USERQNA_NUM DESC
    </select>
    
    <select id="selectReportQna" parameterType="_int" resultMap="userQnaResultSet">
        SELECT * FROM USERQNA WHERE EXUSER_NUM = #{exuserNum} ORDER BY USERQNA_NUM DESC
    </select>
    
    <select id="searchUserQna" parameterType="string" resultMap="userQnaResultSet">
        SELECT * FROM USERQNA 
        WHERE USERQNA_TITLE LIKE '%'||#{keyword}||'%' 
           OR USERQNA LIKE '%'||#{keyword}||'%'
        ORDER BY USERQNA_NUM DESC
    </select>
    
</mapper>